<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What is it made?</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* Light gray background */
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .section-content {
            display: none; /* Hide all sections by default */
        }
        .section-content.active {
            display: block; /* Show active section */
        }
        .nav-link.active {
            background-color: #4f46e5; /* Indigo 600 */
            color: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .correct-answer {
            color: #10b981; /* Emerald 500 */
            font-weight: bold;
        }
        .incorrect-answer {
            color: #ef4444; /* Red 500 */
            font-weight: bold;
        }
        /* Drag and Drop styles */
        .draggable-word {
            cursor: grab;
            background-color: #e0e7ff; /* Indigo 100 */
            border: 1px solid #a5b4fc; /* Indigo 300 */
            padding: 8px 12px;
            border-radius: 8px;
            margin: 4px;
            display: inline-block;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s ease-in-out, background-color 0.2s ease-in-out;
        }
        .draggable-word:active {
            cursor: grabbing;
            transform: scale(1.05);
        }
        .drop-target {
            min-width: 120px;
            min-height: 40px;
            border: 2px dashed #9ca3af; /* Gray 400 */
            background-color: #f9fafb; /* Gray 50 */
            padding: 5px;
            margin: 0 5px;
            display: inline-flex;
            justify-content: center;
            align-items: center;
            vertical-align: middle;
            border-radius: 8px;
            font-weight: 500;
            color: #4b5563; /* Gray 700 */
            transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out;
        }
        .drop-target.hover {
            background-color: #e0e7ff; /* Indigo 100 */
            border-color: #4f46e5; /* Indigo 600 */
        }
        .drop-target.filled {
            border-style: solid;
            border-color: #6366f1; /* Indigo 500 */
            background-color: #eef2ff; /* Indigo 50 */
        }
        .word-bank-container {
            flex: 1;
            padding-right: 20px;
            border-right: 1px solid #e2e8f0; /* Gray 200 */
        }
        .sentences-display-container {
            flex: 2;
            padding-left: 20px;
        }
        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: flex-start; /* Align words to the start */
            margin-bottom: 20px;
        }
        .sentence-container {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            margin-bottom: 15px;
        }

        /* Score summary colours */
        .score-box {
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s ease-in-out;
        }
        .score-box:hover {
            transform: translateY(-5px);
        }
        .score-box.comprehension { background-color: #d1e7dd; color: #0f5132; } /* Light green */
        .score-box.vocabularies { background-color: #cfe2ff; color: #084298; } /* Light blue */
        .score-box.suffixes { background-color: #f8d7da; color: #842029; } /* Light red */
        .score-box.passive { background-color: #fff3cd; color: #664d03; } /* Light yellow */
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
    <header class="bg-gradient-to-r from-indigo-700 to-indigo-900 text-white shadow-xl py-4 px-6 rounded-b-xl">
        <div class="container flex flex-col sm:flex-row justify-between items-center">
            <h1 class="text-3xl font-bold mb-4 sm:mb-0">What is it made?</h1>
            <nav class="flex flex-wrap justify-center gap-2">
                <a href="#home" class="nav-link bg-indigo-500 hover:bg-indigo-600 text-white py-2 px-4 rounded-lg transition duration-300 ease-in-out shadow-md active group" data-section="home">Home</a>
                <a href="#comprehension" class="nav-link bg-indigo-500 hover:bg-indigo-600 text-white py-2 px-4 rounded-lg transition duration-300 ease-in-out shadow-md group" data-section="comprehension">Comprehension</a>
                <a href="#vocabularies" class="nav-link bg-indigo-500 hover:bg-indigo-600 text-white py-2 px-4 rounded-lg transition duration-300 ease-in-out shadow-md group" data-section="vocabularies">Vocabularies (Drag and Fill)</a>
                <a href="#suffixes-game" class="nav-link bg-indigo-500 hover:bg-indigo-600 text-white py-2 px-4 rounded-lg transition duration-300 ease-in-out shadow-md group" data-section="suffixes-game">Suffixes Game</a>
                <a href="#passive-voice-game" class="nav-link bg-indigo-500 hover:bg-indigo-600 text-white py-2 px-4 rounded-lg transition duration-300 ease-in-out shadow-md group" data-section="passive-voice-game">Passive Voice Game</a>
                <a href="#scores" class="nav-link bg-indigo-500 hover:bg-indigo-600 text-white py-2 px-4 rounded-lg transition duration-300 ease-in-out shadow-md group" data-section="scores">Scores</a>
            </nav>
        </div>
    </header>

    <main class="flex-grow container py-8">
        <!-- Home Section -->
        <section id="home" class="section-content active bg-white p-8 rounded-lg shadow-xl mb-8">
            <h2 class="text-3xl font-semibold text-indigo-800 mb-6">Welcome to the Language Learning Hub!</h2>
            <p class="text-lg leading-relaxed mb-4">
                This language learning hub offers a variety of interactive activities to help users improve their English skills. Each section is designed to target specific aspects of language learning, making your journey both effective and enjoyable.
            </p>
            <p class="text-lg leading-relaxed mb-4">
                Here's a brief description of each section:
            </p>
            <ul class="list-disc list-inside space-y-2 text-lg leading-relaxed">
                <li>
                    <strong>Home:</strong> This section provides a welcoming introduction to the Language Learning Hub, explaining its purpose and highlighting the different types of activities available. It also features a general overview of the "How Is It Made?" theme.
                </li>
            </ul>
        </section>

        <!-- Comprehension Section -->
        <section id="comprehension" class="section-content bg-white p-8 rounded-lg shadow-xl mb-8">
            <h2 class="text-3xl font-semibold text-indigo-800 mb-6">Comprehension: A New Life for Your Jeans</h2>
            <p class="text-lg leading-relaxed mb-4">
                Focused on reading comprehension, this section presents questions related to a text about jeans production. Users can answer fill-in-the-blank, multiple-choice, and true/false questions to test their understanding of the provided content.
            </p>
            <div class="bg-gray-50 p-6 rounded-md border border-gray-200 mb-6">
                <h3 class="text-xl font-medium text-gray-700 mb-3">Text: A New Life for Your Jeans</h3>
                <div id="comprehension-text-content" class="text-gray-600 leading-relaxed">
                    <p class="mb-4">
                        Do you have an old pair of jeans that you don't wear anymore? Are you planning to throw them away? Find out how they are made first - and you'll see why it's a good idea to recycle them!
                    </p>
                    <p class="mb-4">
                        A lot of water and energy is needed to make one pair of jeans. Jeans are made from a material called <strong>denim</strong>, and denim is made from a plant called <strong>cotton</strong>. Cotton grows in warm, wet countries like China, India and Brazil. It takes about six months for a cotton seed to grow into a plant and produce cotton. Cotton needs a lot of water to make it grow - some of this comes from rain, but when the weather is dry, farmers need to water the plants. After the cotton is <strong>harvested</strong>, it is transported to a factory and made into <strong>yarn</strong>. Indigo dye is then used to colour the yarn - indigo gives the jeans their dark blue colour. After that, the yarn is made into denim material, which is cut to make jeans.
                    </p>
                    <p class="mb-4">
                        Lots of people like stonewashed jeans. To make these, jeans are then put into a washing machine and washed with stones to make them soft and more comfortable. Stonewashing can also change the colour of the denim to light blue. Finally, the jeans are packed into boxes and transported all over the world. Jeans travel up to 60,000 kilometres to reach the shops, where you can buy them! Almost half of the jeans made in the world are sold in the USA. Last year, people there bought 450 million pairs of jeans.
                    </p>
                    <p>
                        To make one pair of jeans, 10,000 litres of water and many other resources are used - resources are all the things you need to make or do something, like energy, materials and people to do the work. So we really shouldn't throw away old jeans. Just because they're too small or because we have a new pair. But what can you do with an old pair of jeans?
                    </p>
                    <h3 class="text-xl font-medium text-gray-700 mt-6 mb-3">Here are some suggestions:</h3>
                    <ul class="list-disc list-inside text-gray-600 space-y-1">
                        <li>Give them to friends or family.</li>
                        <li>Take them to a charity shop.</li>
                        <li>Have a swapping party, where people exchange things they don't need, like clothes or books.</li>
                        <li>Make them into a new creation, like a bag or a toy.</li>
                    </ul>
                </div>
            </div>

            <div class="bg-white p-8 rounded-lg shadow-xl">
                <h3 class="text-2xl font-semibold text-indigo-800 mb-4">Comprehension Questions</h3>
                <form id="comprehension-quiz" class="space-y-6">
                    <!-- Question 1: Fill-in-the-blank -->
                    <div>
                        <p class="text-lg mb-2">1. Jeans are made from a material called <input type="text" id="q1" class="inline-block w-32 p-1 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500" data-answer="denim">.</p>
                        <span id="feedback-q1" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 2: Multiple Choice -->
                    <div>
                        <p class="text-lg mb-2">2. What plant is denim made from?</p>
                        <div class="space-y-2">
                            <label class="block"><input type="radio" name="q2" value="cotton" class="mr-2"> Cotton</label>
                            <label class="block"><input type="radio" name="q2" value="linen" class="mr-2"> Linen</label>
                            <label class="block"><input type="radio" name="q2" value="wool" class="mr-2"> Wool</label>
                        </div>
                        <span id="feedback-q2" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 3: True/False -->
                    <div>
                        <p class="text-lg mb-2">3. Cotton grows best in cold, dry countries. (True/False)</p>
                        <div class="space-x-4">
                            <label><input type="radio" name="q3" value="false" class="mr-2"> True</label>
                            <label><input type="radio" name="q3" value="true" class="mr-2"> False</label>
                        </div>
                        <span id="feedback-q3" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 4: Fill-in-the-blank -->
                    <div>
                        <p class="text-lg mb-2">4. It takes about <input type="text" id="q4" class="inline-block w-24 p-1 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500" data-answer="six,6"> months for a cotton seed to grow into a plant.</p>
                        <span id="feedback-q4" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 5: Multiple Choice -->
                    <div>
                        <p class="text-lg mb-2">5. What is used to colour the yarn for jeans?</p>
                        <div class="space-y-2">
                            <label class="block"><input type="radio" name="q5" value="indigo dye" class="mr-2"> Indigo dye</label>
                            <label class="block"><input type="radio" name="q5" value="red dye" class="mr-2"> Red dye</label>
                            <label class="block"><input type="radio" name="q5" value="green dye" class="mr-2"> Green dye</label>
                        </div>
                        <span id="feedback-q5" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 6: True/False -->
                    <div>
                        <p class="text-lg mb-2">6. Stonewashed jeans are made by washing them with hot water only. (True/False)</p>
                        <div class="space-x-4">
                            <label><input type="radio" name="q6" value="false" class="mr-2"> True</label>
                            <label><input type="radio" name="q6" value="true" class="mr-2"> False</label>
                        </div>
                        <span id="feedback-q6" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 7: Fill-in-the-blank -->
                    <div>
                        <p class="text-lg mb-2">7. Stonewashing makes jeans feel <input type="text" id="q7" class="inline-block w-24 p-1 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500" data-answer="soft"> and more comfortable.</p>
                        <span id="feedback-q7" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 8: Multiple Choice -->
                    <div>
                        <p class="text-lg mb-2">8. How far can jeans travel to reach the shops?</p>
                        <div class="space-y-2">
                            <label class="block"><input type="radio" name="q8" value="10,000 kilometres" class="mr-2"> 10,000 kilometres</label>
                            <label class="block"><input type="radio" name="q8" value="60,000 kilometres" class="mr-2"> 60,000 kilometres</label>
                            <label class="block"><input type="radio" name="q8" value="100,000 kilometres" class="mr-2"> 100,000 kilometres</label>
                        </div>
                        <span id="feedback-q8" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 9: True/False -->
                    <div>
                        <p class="text-lg mb-2">9. Almost all jeans made in the world are sold in the USA. (True/False)</p>
                        <div class="space-x-4">
                            <label><input type="radio" name="q9" value="false" class="mr-2"> True</label>
                            <label><input type="radio" name="q9" value="true" class="mr-2"> False</label>
                        </div>
                        <span id="feedback-q9" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 10: Fill-in-the-blank -->
                    <div>
                        <p class="text-lg mb-2">10. Last year, people in the USA bought <input type="text" id="q10" class="inline-block w-24 p-1 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500" data-answer="450"> million pairs of jeans.</p>
                        <span id="feedback-q10" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 11: Multiple Choice -->
                    <div>
                        <p class="text-lg mb-2">11. How much water is needed to make one pair of jeans?</p>
                        <div class="space-y-2">
                            <label class="block"><input type="radio" name="q11" value="1,000 litres" class="mr-2"> 1,000 litres</label>
                            <label class="block"><input type="radio" name="q11" value="5,000 litres" class="mr-2"> 5,000 litres</label>
                            <label class="block"><input type="radio" name="q11" value="10,000 litres" class="mr-2"> 10,000 litres</label>
                        </div>
                        <span id="feedback-q11" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 12: True/False -->
                    <div>
                        <p class="text-lg mb-2">12. "Resources" include only materials needed to make something. (True/False)</p>
                        <div class="space-x-4">
                            <label><input type="radio" name="q12" value="false" class="mr-2"> True</label>
                            <label><input type="radio" name="q12" value="true" class="mr-2"> False</label>
                        </div>
                        <span id="feedback-q12" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 13: Fill-in-the-blank -->
                    <div>
                        <p class="text-lg mb-2">13. One suggestion for old jeans is to take them to a <input type="text" id="q13" class="inline-block w-28 p-1 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500" data-answer="charity"> shop.</p>
                        <span id="feedback-q13" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 14: Multiple Choice -->
                    <div>
                        <p class="text-lg mb-2">14. What is one way to give old jeans a "new creation"?</p>
                        <div class="space-y-2">
                            <label class="block"><input type="radio" name="q14" value="throw them away" class="mr-2"> Throw them away</label>
                            <label class="block"><input type="radio" name="q14" value="make them into a bag" class="mr-2"> Make them into a bag or a toy</label>
                            <label class="block"><input type="radio" name="q14" value="sell them for profit" class="mr-2"> Sell them for profit</label>
                        </div>
                        <span id="feedback-q14" class="text-sm mt-1"></span>
                    </div>

                    <!-- Question 15: True/False -->
                    <div>
                        <p class="text-lg mb-2">15. You should always throw away old jeans if they are too small. (True/False)</p>
                        <div class="space-x-4">
                            <label><input type="radio" name="q15" value="false" class="mr-2"> True</label>
                            <label><input type="radio" name="q15" value="true" class="mr-2"> False</label>
                        </div>
                        <span id="feedback-q15" class="text-sm mt-1"></span>
                    </div>

                    <button type="button" id="check-answers-btn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105">Check Answers</button>
                    <div id="quiz-summary" class="mt-4 text-xl font-semibold text-indigo-800"></div>
                </form>
            </div>
        </section>

        <!-- Vocabularies (Drag and Fill) Section -->
        <section id="vocabularies" class="section-content bg-white p-8 rounded-lg shadow-xl mb-8">
            <h2 class="text-3xl font-semibold text-indigo-800 mb-6">Vocabularies (Drag and Fill)</h2>
            <p class="text-lg leading-relaxed mb-4">
                This interactive game challenges users to drag and drop vocabulary words into the correct blanks within sentences. It helps reinforce word usage and context, making vocabulary acquisition fun and engaging.
            </p>
            <div class="bg-gray-50 p-6 rounded-md border border-gray-200 flex flex-col md:flex-row">
                <div class="word-bank-container md:w-1/3 mb-6 md:mb-0">
                    <h3 class="text-xl font-medium text-gray-700 mb-3">Word Bank</h3>
                    <div id="word-bank" class="word-bank">
                        <!-- Draggable words will be populated here by JavaScript -->
                    </div>
                </div>
                <div class="sentences-display-container md:w-2/3">
                    <h3 class="text-xl font-medium text-gray-700 mb-3">Drag and Fill Sentences</h3>
                    <div id="sentences-container" class="space-y-4">
                        <!-- Sentences with drop targets will be populated here by JavaScript -->
                    </div>
                    <button type="button" id="check-vocab-btn" class="mt-6 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105">Check Vocabulary</button>
                    <div id="vocab-summary" class="mt-4 text-xl font-semibold text-indigo-800"></div>
                </div>
            </div>
        </section>

        <!-- Suffixes Game Section -->
        <section id="suffixes-game" class="section-content bg-white p-8 rounded-lg shadow-xl mb-8">
            <h2 class="text-3xl font-semibold text-indigo-800 mb-6">Suffixes Game</h2>
            <p class="text-lg leading-relaxed mb-4">
                This game focuses on the correct application of "-sion" and "-tion" suffixes. Users are presented with a base word, choose the correct suffix to form a noun, and then select the correct meaning of the newly formed word. It's a great way to master tricky English spellings and meanings.
            </p>
            <div class="bg-gray-50 p-6 rounded-md border border-gray-200">
                <h3 class="text-xl font-medium text-gray-700 mb-3">Suffixes Game: -sion vs. -tion</h3>
                <div id="suffixes-quiz" class="space-y-6">
                    <!-- Suffix questions will be populated here by JavaScript -->
                </div>
                <button type="button" id="check-suffixes-btn" class="mt-6 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105">Check Suffixes</button>
                <div id="suffixes-summary" class="mt-4 text-xl font-semibold text-indigo-800"></div>
            </div>
        </section>

        <!-- Passive Voice Game Section -->
        <section id="passive-voice-game" class="section-content bg-white p-8 rounded-lg shadow-xl mb-8">
            <h2 class="text-3xl font-semibold text-indigo-800 mb-6">Passive Voice Game</h2>
            <p class="text-lg leading-relaxed mb-4">
                In this section, users practice transforming active voice sentences into passive voice using various interactive question types.
            </p>
            <div class="bg-gray-50 p-6 rounded-md border border-gray-200">
                <h3 class="text-xl font-medium text-gray-700 mb-3">Passive Voice Transformation</h3>
                <div id="passive-voice-quiz" class="space-y-6">
                    <!-- Passive voice questions will be populated here by JavaScript -->
                </div>
                <button type="button" id="check-passive-btn" class="mt-6 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition duration-300 ease-in-out transform hover:scale-105">Check Passive Voice</button>
                <div id="passive-summary" class="mt-4 text-xl font-semibold text-indigo-800"></div>
            </div>
        </section>

        <!-- Scores Section -->
        <section id="scores" class="section-content bg-white p-8 rounded-lg shadow-xl mb-8">
            <h2 class="text-3xl font-semibold text-indigo-800 mb-6">Scores</h2>
            <p class="text-lg leading-relaxed mb-4">
                This tab provides a summary of your performance across all the games. Track your progress and see where you excel!
            </p>
            <div id="score-display" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 text-center">
                <div class="score-box comprehension">
                    <h4 class="text-2xl font-bold mb-2">Comprehension</h4>
                    <p class="text-4xl font-extrabold"><span id="score-comprehension">0/15</span></p>
                </div>
                <div class="score-box vocabularies">
                    <h4 class="text-2xl font-bold mb-2">Vocabularies</h4>
                    <p class="text-4xl font-extrabold"><span id="score-vocabularies">0/0</span></p>
                </div>
                <div class="score-box suffixes">
                    <h4 class="text-2xl font-bold mb-2">Suffixes Game</h4>
                    <p class="text-4xl font-extrabold"><span id="score-suffixes">0/0</span></p>
                </div>
                <div class="score-box passive">
                    <h4 class="text-2xl font-bold mb-2">Passive Voice</h4>
                    <p class="text-4xl font-extrabold"><span id="score-passive">0/0</span></p>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-gradient-to-r from-indigo-700 to-indigo-900 text-white py-6 px-6 mt-auto rounded-t-xl shadow-inner">
        <div class="container text-center text-sm">
            &copy; 2025 Chua Yi Rou
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navLinks = document.querySelectorAll('.nav-link');
            const sections = document.querySelectorAll('.section-content');
            const checkAnswersBtn = document.getElementById('check-answers-btn');
            const quizSummary = document.getElementById('quiz-summary');

            // Scores object to store progress
            const scores = {
                comprehension: 0,
                vocabularies: 0,
                suffixes: { correct: 0, total: 0 },
                passiveVoice: 0,
                totalComprehension: 15,
                totalVocabularies: 0,
                totalSuffixes: 0,
                totalPassiveVoice: 0
            };

            // Function to update scores display
            const updateScoresDisplay = () => {
                document.getElementById('score-comprehension').textContent = `${scores.comprehension}/${scores.totalComprehension}`;
                document.getElementById('score-vocabularies').textContent = `${scores.vocabularies}/${scores.totalVocabularies}`;
                document.getElementById('score-suffixes').textContent = `${scores.suffixes.correct}/${scores.totalSuffixes}`;
                document.getElementById('score-passive').textContent = `${scores.passiveVoice}/${scores.totalPassiveVoice}`;
            };

            // Function to show a specific section and update active link
            const showSection = (sectionId) => {
                sections.forEach(section => {
                    section.classList.remove('active');
                });
                document.getElementById(sectionId).classList.add('active');

                navLinks.forEach(link => {
                    link.classList.remove('active');
                });
                document.querySelector(`.nav-link[data-section="${sectionId}"]`).classList.add('active');

                // Update scores display when scores section is active
                if (sectionId === 'scores') {
                    updateScoresDisplay();
                }
            };

            // Add click event listeners to navigation links
            navLinks.forEach(link => {
                link.addEventListener('click', (event) => {
                    event.preventDefault(); // Prevent default anchor link behaviour
                    const sectionId = event.target.dataset.section;
                    showSection(sectionId);
                });
            });

            // Handle initial section display based on URL hash or default to home
            const initialHash = window.location.hash.substring(1);
            if (initialHash && document.getElementById(initialHash)) {
                showSection(initialHash);
            } else {
                showSection('home'); // Default to home section
            }

            // Comprehension Quiz Logic
            checkAnswersBtn.addEventListener('click', () => {
                let currentCorrectCount = 0;
                const totalQuestions = 15;

                // Question 1 (Fill-in-the-blank)
                const q1Input = document.getElementById('q1');
                const q1Feedback = document.getElementById('feedback-q1');
                const q1Answers = q1Input.dataset.answer.split(',').map(ans => ans.trim().toLowerCase());
                if (q1Answers.includes(q1Input.value.trim().toLowerCase())) {
                    q1Feedback.textContent = 'Correct!';
                    q1Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q1Feedback.textContent = `Incorrect. Accepted answers: "${q1Input.dataset.answer.split(',').join('", "')}".`;
                    q1Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 2 (Multiple Choice)
                const q2Radios = document.querySelectorAll('input[name="q2"]');
                const q2Feedback = document.getElementById('feedback-q2');
                let q2AnsweredCorrectly = false;
                q2Radios.forEach(radio => {
                    if (radio.checked && radio.value === 'cotton') {
                        q2AnsweredCorrectly = true;
                    }
                });
                if (q2AnsweredCorrectly) {
                    q2Feedback.textContent = 'Correct!';
                    q2Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q2Feedback.textContent = 'Incorrect. The answer is "Cotton".';
                    q2Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 3 (True/False)
                const q3Radios = document.querySelectorAll('input[name="q3"]');
                const q3Feedback = document.getElementById('feedback-q3');
                let q3AnsweredCorrectly = false;
                q3Radios.forEach(radio => {
                    if (radio.checked && radio.value === 'true') { // The statement is "Cotton grows best in cold, dry countries." which is FALSE. So the correct radio value is 'true' for 'False'.
                        q3AnsweredCorrectly = true;
                    }
                });
                if (q3AnsweredCorrectly) {
                    q3Feedback.textContent = 'Correct!';
                    q3Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q3Feedback.textContent = 'Incorrect. The statement is False.';
                    q3Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 4 (Fill-in-the-blank)
                const q4Input = document.getElementById('q4');
                const q4Feedback = document.getElementById('feedback-q4');
                const q4Answers = q4Input.dataset.answer.split(',').map(ans => ans.trim().toLowerCase());
                if (q4Answers.includes(q4Input.value.trim().toLowerCase())) {
                    q4Feedback.textContent = 'Correct!';
                    q4Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q4Feedback.textContent = `Incorrect. Accepted answers: "${q4Input.dataset.answer.split(',').join('", "')}".`;
                    q4Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 5 (Multiple Choice)
                const q5Radios = document.querySelectorAll('input[name="q5"]');
                const q5Feedback = document.getElementById('feedback-q5');
                let q5AnsweredCorrectly = false;
                q5Radios.forEach(radio => {
                    if (radio.checked && radio.value === 'indigo dye') {
                        q5AnsweredCorrectly = true;
                    }
                });
                if (q5AnsweredCorrectly) {
                    q5Feedback.textContent = 'Correct!';
                    q5Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q5Feedback.textContent = 'Incorrect. The answer is "Indigo dye".';
                    q5Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 6 (True/False)
                const q6Radios = document.querySelectorAll('input[name="q6"]');
                const q6Feedback = document.getElementById('feedback-q6');
                let q6AnsweredCorrectly = false;
                q6Radios.forEach(radio => {
                    if (radio.checked && radio.value === 'true') { // The statement is "Stonewashed jeans are made by washing them with hot water only." which is FALSE. So the correct radio value is 'true' for 'False'.
                        q6AnsweredCorrectly = true;
                    }
                });
                if (q6AnsweredCorrectly) {
                    q6Feedback.textContent = 'Correct!';
                    q6Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q6Feedback.textContent = 'Incorrect. The statement is False.';
                    q6Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 7 (Fill-in-the-blank)
                const q7Input = document.getElementById('q7');
                const q7Feedback = document.getElementById('feedback-q7');
                const q7Answers = q7Input.dataset.answer.split(',').map(ans => ans.trim().toLowerCase());
                if (q7Answers.includes(q7Input.value.trim().toLowerCase())) {
                    q7Feedback.textContent = 'Correct!';
                    q7Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q7Feedback.textContent = `Incorrect. Accepted answers: "${q7Input.dataset.answer.split(',').join('", "')}".`;
                    q7Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 8 (Multiple Choice)
                const q8Radios = document.querySelectorAll('input[name="q8"]');
                const q8Feedback = document.getElementById('feedback-q8');
                let q8AnsweredCorrectly = false;
                q8Radios.forEach(radio => {
                    if (radio.checked && radio.value === '60,000 kilometres') {
                        q8AnsweredCorrectly = true;
                    }
                });
                if (q8AnsweredCorrectly) {
                    q8Feedback.textContent = 'Correct!';
                    q8Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q8Feedback.textContent = 'Incorrect. The answer is "60,000 kilometres".';
                    q8Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 9 (True/False)
                const q9Radios = document.querySelectorAll('input[name="q9"]');
                const q9Feedback = document.getElementById('feedback-q9');
                let q9AnsweredCorrectly = false;
                q9Radios.forEach(radio => {
                    if (radio.checked && radio.value === 'true') { // The statement is "Almost all jeans made in the world are sold in the USA." which is FALSE. So the correct radio value is 'true' for 'False'.
                        q9AnsweredCorrectly = true;
                    }
                });
                if (q9AnsweredCorrectly) {
                    q9Feedback.textContent = 'Correct!';
                    q9Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q9Feedback.textContent = 'Incorrect. The statement is False.';
                    q9Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 10 (Fill-in-the-blank)
                const q10Input = document.getElementById('q10');
                const q10Feedback = document.getElementById('feedback-q10');
                const q10Answers = q10Input.dataset.answer.split(',').map(ans => ans.trim().toLowerCase());
                if (q10Answers.includes(q10Input.value.trim().toLowerCase())) {
                    q10Feedback.textContent = 'Correct!';
                    q10Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q10Feedback.textContent = `Incorrect. Accepted answers: "${q10Input.dataset.answer.split(',').join('", "')}".`;
                    q10Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 11 (Multiple Choice)
                const q11Radios = document.querySelectorAll('input[name="q11"]');
                const q11Feedback = document.getElementById('feedback-q11');
                let q11AnsweredCorrectly = false;
                q11Radios.forEach(radio => {
                    if (radio.checked && radio.value === '10,000 litres') {
                        q11AnsweredCorrectly = true;
                    }
                });
                if (q11AnsweredCorrectly) {
                    q11Feedback.textContent = 'Correct!';
                    q11Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q11Feedback.textContent = 'Incorrect. The answer is "10,000 litres".';
                    q11Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 12 (True/False)
                const q12Radios = document.querySelectorAll('input[name="q12"]');
                const q12Feedback = document.getElementById('feedback-q12');
                let q12AnsweredCorrectly = false;
                q12Radios.forEach(radio => {
                    if (radio.checked && radio.value === 'true') { // The statement is "Resources" include only materials needed to make something." which is FALSE. So the correct radio value is 'true' for 'False'.
                        q12AnsweredCorrectly = true;
                    }
                });
                if (q12AnsweredCorrectly) {
                    q12Feedback.textContent = 'Correct!';
                    q12Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q12Feedback.textContent = 'Incorrect. The statement is False.';
                    q12Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 13 (Fill-in-the-blank)
                const q13Input = document.getElementById('q13');
                const q13Feedback = document.getElementById('feedback-q13');
                const q13Answers = q13Input.dataset.answer.split(',').map(ans => ans.trim().toLowerCase());
                if (q13Answers.includes(q13Input.value.trim().toLowerCase())) {
                    q13Feedback.textContent = 'Correct!';
                    q13Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q13Feedback.textContent = `Incorrect. Accepted answers: "${q13Input.dataset.answer.split(',').join('", "')}".`;
                    q13Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 14 (Multiple Choice)
                const q14Radios = document.querySelectorAll('input[name="q14"]');
                const q14Feedback = document.getElementById('feedback-q14');
                let q14AnsweredCorrectly = false;
                q14Radios.forEach(radio => {
                    if (radio.checked && radio.value === 'make them into a bag') {
                        q14AnsweredCorrectly = true;
                    }
                });
                if (q14AnsweredCorrectly) {
                    q14Feedback.textContent = 'Correct!';
                    q14Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q14Feedback.textContent = 'Incorrect. The answer is "Make them into a bag or a toy".';
                    q14Feedback.className = 'text-sm mt-1 incorrect-answer';
                }

                // Question 15 (True/False)
                const q15Radios = document.querySelectorAll('input[name="q15"]');
                const q15Feedback = document.getElementById('feedback-q15');
                let q15AnsweredCorrectly = false;
                q15Radios.forEach(radio => {
                    if (radio.checked && radio.value === 'true') { // The statement is "You should always throw away old jeans if they are too small." which is FALSE. So the correct radio value is 'true' for 'False'.
                        q15AnsweredCorrectly = true;
                    }
                });
                if (q15AnsweredCorrectly) {
                    q15Feedback.textContent = 'Correct!';
                    q15Feedback.className = 'text-sm mt-1 correct-answer';
                    currentCorrectCount++;
                } else {
                    q15Feedback.textContent = 'Incorrect. The statement is False.';
                    q15Feedback.className = 'text-sm mt-1 incorrect-answer';
                }


                quizSummary.textContent = `You got ${currentCorrectCount} out of ${totalQuestions} questions correct!`;
                scores.comprehension = currentCorrectCount;
                updateScoresDisplay();
            });

            // Vocabularies (Drag and Fill) Game Logic
            const vocabWords = ['cotton', 'dark', 'denim', 'dye', 'harvest', 'jeans', 'light', 'useful', 'special', 'cheap'];
            const vocabSentences = [
                {
                    sentence: "The fabric used for blue jeans is called ",
                    blank: "denim",
                    after: "."
                },
                {
                    sentence: "Farmers often ",
                    blank: "harvest",
                    after: " their crops in the autumn."
                },
                {
                    sentence: "Indigo ",
                    blank: "dye",
                    after: " gives the fabric its blue colour."
                },
                {
                    sentence: "Many people prefer their coffee ",
                    blank: "dark",
                    after: " and strong."
                },
                {
                    sentence: "This tool is very ",
                    blank: "useful",
                    after: " for gardening."
                },
                {
                    sentence: "She bought a new pair of ",
                    blank: "jeans",
                    after: " yesterday."
                },
                {
                    sentence: "The colour of the sky became ",
                    blank: "light",
                    after: " as the sun rose."
                },
                {
                    sentence: "This shirt is made from pure ",
                    blank: "cotton",
                    after: "."
                },
                {
                    sentence: "The antique vase was very ",
                    blank: "special",
                    after: "."
                },
                {
                    sentence: "I found a ",
                    blank: "cheap",
                    after: " flight to Paris."
                }
            ];

            scores.totalVocabularies = vocabSentences.length;

            const wordBank = document.getElementById('word-bank');
            const sentencesContainer = document.getElementById('sentences-container');
            const checkVocabBtn = document.getElementById('check-vocab-btn');
            const vocabSummary = document.getElementById('vocab-summary');

            // Shuffle words for the word bank
            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            const shuffledVocabWords = shuffleArray([...vocabWords]); // Create a copy to shuffle

            shuffledVocabWords.forEach(word => {
                const wordElement = document.createElement('div');
                wordElement.classList.add('draggable-word', 'px-3', 'py-1', 'rounded-md', 'shadow-sm', 'cursor-grab', 'bg-blue-200', 'text-blue-800');
                wordElement.textContent = word;
                wordElement.setAttribute('draggable', true);
                wordElement.dataset.word = word;
                wordBank.appendChild(wordElement);
            });

            vocabSentences.forEach((item, index) => {
                const sentenceDiv = document.createElement('div');
                sentenceDiv.classList.add('sentence-container', 'text-lg', 'flex', 'items-center', 'flex-wrap');
                sentenceDiv.innerHTML = `
                    <span class="mr-2">${index + 1}.</span>
                    <span>${item.sentence}</span>
                    <div class="drop-target" data-correct-answer="${item.blank.toLowerCase()}" data-sentence-index="${index}"></div>
                    <span>${item.after}</span>
                    <span id="vocab-feedback-${index}" class="ml-2 text-sm"></span>
                `;
                sentencesContainer.appendChild(sentenceDiv);
            });

            let draggedItem = null;

            document.querySelectorAll('.draggable-word').forEach(word => {
                word.addEventListener('dragstart', (e) => {
                    draggedItem = e.target;
                    e.dataTransfer.setData('text/plain', e.target.dataset.word);
                    setTimeout(() => {
                        e.target.classList.add('hidden');
                    }, 0);
                });

                word.addEventListener('dragend', () => {
                    setTimeout(() => {
                        if (draggedItem) {
                            draggedItem.classList.remove('hidden');
                            draggedItem = null;
                        }
                    }, 0);
                });
            });

            document.querySelectorAll('.drop-target').forEach(target => {
                target.addEventListener('dragover', (e) => {
                    e.preventDefault(); // Allow drop
                    target.classList.add('hover');
                });

                target.addEventListener('dragleave', () => {
                    target.classList.remove('hover');
                });

                target.addEventListener('drop', (e) => {
                    e.preventDefault();
                    target.classList.remove('hover');
                    const word = e.dataTransfer.getData('text/plain');

                    // If a word is already in the target, move it back to the bank
                    if (target.textContent.includes("Drop words here")) {
                        target.textContent = '';
                    }

                    const wordElement = document.createElement('span');
                    wordElement.classList.add('draggable-word', 'px-3', 'py-1', 'rounded-md', 'shadow-sm', 'cursor-grab', 'bg-blue-200', 'text-blue-800');
                    wordElement.textContent = word;
                    wordElement.setAttribute('draggable', true);
                    wordElement.dataset.word = word;
                    target.appendChild(wordElement);

                    // Re-add drag listeners for newly dropped words (if they are moved again)
                    wordElement.addEventListener('dragstart', (e) => {
                        draggedItem = e.target;
                        e.dataTransfer.setData('text/plain', e.target.dataset.word);
                        setTimeout(() => {
                            e.target.classList.add('hidden');
                        }, 0);
                    });
                    wordElement.addEventListener('dragend', () => {
                        setTimeout(() => {
                            if (draggedItem) {
                                draggedItem.classList.remove('hidden');
                                draggedItem = null;
                            }
                        }, 0);
                    });
                });
            });

            checkVocabBtn.addEventListener('click', () => {
                let currentCorrectVocab = 0;
                document.querySelectorAll('.drop-target').forEach((target, index) => {
                    const feedbackSpan = document.getElementById(`vocab-feedback-${index}`);
                    if (target.dataset.currentWord && target.dataset.currentWord.toLowerCase() === target.dataset.correctAnswer) {
                        feedbackSpan.textContent = 'Correct!';
                        feedbackSpan.className = 'ml-2 text-sm correct-answer';
                        currentCorrectVocab++;
                    } else {
                        feedbackSpan.textContent = `Incorrect. Correct: "${target.dataset.correctAnswer}"`;
                        feedbackSpan.className = 'ml-2 text-sm incorrect-answer';
                    }
                });
                vocabSummary.textContent = `You got ${currentCorrectVocab} out of ${scores.totalVocabularies} correct!`;
                scores.vocabularies = currentCorrectVocab;
                updateScoresDisplay();
            });

            // Suffixes Game Logic
            const suffixesQuestions = [
                {
                    baseWord: "discuss",
                    correctSuffix: "sion",
                    correctForm: "discussion",
                    meanings: [
                        { text: "a conversation or debate about a particular topic", isCorrect: true },
                        { text: "the act of deciding", isCorrect: false },
                        { text: "a state of being confused", isCorrect: false }
                    ]
                },
                {
                    baseWord: "invent",
                    correctSuffix: "tion",
                    correctForm: "invention",
                    meanings: [
                        { text: "a new product, system, or process that has been created", isCorrect: true },
                        { text: "the act of inviting someone", isCorrect: false },
                        { text: "a strong feeling of dislike", isCorrect: false }
                    ]
                },
                {
                    baseWord: "express",
                    correctSuffix: "sion",
                    correctForm: "expression",
                    meanings: [
                        { text: "the process of making known one's thoughts or feelings", isCorrect: true },
                        { text: "a quick journey", isCorrect: false },
                        { text: "the act of pressing something", isCorrect: false }
                    ]
                },
                {
                    baseWord: "educate",
                    correctSuffix: "tion",
                    correctForm: "education",
                    meanings: [
                        { text: "the process of receiving or giving systematic instruction", isCorrect: true },
                        { text: "a type of plant", isCorrect: false },
                        { text: "the act of eating", isCorrect: false }
                    ]
                },
                {
                    baseWord: "divide",
                    correctSuffix: "sion",
                    correctForm: "division",
                    meanings: [
                        { text: "the act of separating into parts", isCorrect: true },
                        { text: "a type of dance", isCorrect: false },
                        { text: "the act of driving", isCorrect: false }
                    ]
                }
            ];

            scores.totalSuffixes = suffixesQuestions.length;

            const suffixesQuizDiv = document.getElementById('suffixes-quiz');
            const checkSuffixesBtn = document.getElementById('check-suffixes-btn');
            const suffixesSummary = document.getElementById('suffixes-summary');

            suffixesQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.classList.add('p-4', 'border', 'border-gray-200', 'rounded-md', 'bg-white', 'shadow-sm');
                questionDiv.innerHTML = `
                    <p class="text-lg mb-2"><strong>${index + 1}. Base Word:</strong> ${q.baseWord}</p>
                    <div class="mb-3">
                        <p class="text-md mb-1 font-semibold">Choose the correct suffix:</p>
                        <label class="inline-flex items-center mr-4">
                            <input type="radio" name="suffix-q${index}" value="sion" class="form-radio text-indigo-600">
                            <span class="ml-2">-sion</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" name="suffix-q${index}" value="tion" class="form-radio text-indigo-600">
                            <span class="ml-2">-tion</span>
                        </label>
                        <span id="suffix-feedback-${index}" class="ml-2 text-sm"></span>
                    </div>
                    <div id="meaning-options-${index}" class="mb-3 hidden">
                        <p class="text-md mb-1 font-semibold">Select the correct meaning for "${q.correctForm}":</p>
                        ${q.meanings.map((m, mIndex) => `
                            <label class="block"><input type="radio" name="meaning-q${index}" value="${m.isCorrect}" class="mr-2"> ${m.text}</label>
                        `).join('')}
                        <span id="meaning-feedback-${index}" class="ml-2 text-sm"></span>
                    </div>
                `;
                suffixesQuizDiv.appendChild(questionDiv);

                // Add event listener to suffix radios to show meaning options
                questionDiv.querySelectorAll(`input[name="suffix-q${index}"]`).forEach(radio => {
                    radio.addEventListener('change', (e) => {
                        const meaningOptionsDiv = document.getElementById(`meaning-options-${index}`);
                        meaningOptionsDiv.classList.remove('hidden');
                    });
                });
            });

            checkSuffixesBtn.addEventListener('click', () => {
                let currentCorrectSuffixes = 0;
                suffixesQuestions.forEach((q, index) => {
                    const suffixRadios = document.querySelectorAll(`input[name="suffix-q${index}"]`);
                    const suffixFeedback = document.getElementById(`suffix-feedback-${index}`);
                    const meaningRadios = document.querySelectorAll(`input[name="meaning-q${index}"]`);
                    const meaningFeedback = document.getElementById(`meaning-feedback-${index}`);

                    let suffixCorrect = false;
                    suffixRadios.forEach(radio => {
                        if (radio.checked && radio.value === q.correctSuffix) {
                            suffixCorrect = true;
                        }
                    });

                    if (suffixCorrect) {
                        suffixFeedback.textContent = 'Correct suffix!';
                        suffixFeedback.className = 'ml-2 text-sm correct-answer';
                        let meaningCorrect = false;
                        meaningRadios.forEach(radio => {
                            if (radio.checked && radio.value === 'true') {
                                meaningCorrect = true;
                            }
                        });
                        if (meaningCorrect) {
                            meaningFeedback.textContent = 'Correct meaning!';
                            meaningFeedback.className = 'ml-2 text-sm correct-answer';
                            currentCorrectSuffixes++;
                        } else {
                            meaningFeedback.textContent = 'Incorrect meaning.';
                            meaningFeedback.className = 'ml-2 text-sm incorrect-answer';
                        }
                    } else {
                        suffixFeedback.textContent = `Incorrect suffix. It's -${q.correctSuffix}.`;
                        suffixFeedback.className = 'ml-2 text-sm incorrect-answer';
                        meaningFeedback.textContent = ''; // Clear meaning feedback if suffix is wrong
                    }
                });
                scores.suffixes.correct = currentCorrectSuffixes;
                suffixesSummary.textContent = `You got ${scores.suffixes.correct} out of ${scores.totalSuffixes} correct!`;
                updateScoresDisplay();
            });

            // Passive Voice Game Logic
            const passiveVoiceQuestions = [
                {
                    type: "typing",
                    active: "The student wrote the essay.",
                    passive: "The essay was written by the student."
                },
                {
                    type: "multiple-choice",
                    active: "The company will launch a new product.",
                    options: [
                        "A new product will be launched by the company.",
                        "A new product is launched by the company.",
                        "The company is launching a new product."
                    ],
                    correct: "A new product will be launched by the company."
                },
                {
                    type: "scramble",
                    active: "They are building a new bridge.",
                    passiveWords: ["A", "new", "bridge", "is", "being", "built", "by", "them", "."]
                },
                {
                    type: "typing",
                    active: "She has finished the report.",
                    passive: "The report has been finished by her."
                },
                {
                    type: "multiple-choice",
                    active: "The strong wind blew down the tree.",
                    options: [
                        "The tree was blowing down by the strong wind.",
                        "The tree was blown down by the strong wind.",
                        "The tree is blown down by the strong wind."
                    ],
                    correct: "The tree was blown down by the strong wind."
                }
            ];

            scores.totalPassiveVoice = passiveVoiceQuestions.length;

            const passiveVoiceQuizDiv = document.getElementById('passive-voice-quiz');
            const checkPassiveBtn = document.getElementById('check-passive-btn');
            const passiveSummary = document.getElementById('passive-summary');

            passiveVoiceQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.classList.add('p-4', 'border', 'border-gray-200', 'rounded-md', 'bg-white', 'shadow-sm');
                let questionContent = `<p class="text-lg mb-2"><strong>${index + 1}. Active Voice:</strong> ${q.active}</p>`;

                if (q.type === "typing") {
                    questionContent += `
                        <p class="text-md mb-1">Transform to Passive Voice:</p>
                        <input type="text" id="passive-q${index}" class="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500" data-correct-passive="${q.passive.toLowerCase().replace(/[.,!?;]/g, '').trim()}">
                        <span id="passive-feedback-${index}" class="text-sm mt-1"></span>
                    `;
                } else if (q.type === "multiple-choice") {
                    questionContent += `
                        <p class="text-md mb-1">Select the correct Passive Voice sentence:</p>
                        <div class="space-y-2">
                            ${q.options.map((option, optIndex) => `
                                <label class="block"><input type="radio" name="passive-q${index}" value="${option.toLowerCase().replace(/[.,!?;]/g, '').trim()}" class="mr-2"> ${option}</label>
                            `).join('')}
                        </div>
                        <span id="passive-feedback-${index}" class="text-sm mt-1"></span>
                    `;
                } else if (q.type === "scramble") {
                    const scrambledWords = shuffleArray([...q.passiveWords]);
                    questionContent += `
                        <p class="text-md mb-1">Rearrange the words to form the Passive Voice sentence:</p>
                        <div class="flex flex-wrap gap-2 mb-3" id="scrambled-words-${index}">
                            ${scrambledWords.map(word => `<span class="draggable-word px-3 py-1 rounded-md shadow-sm cursor-grab bg-purple-200 text-purple-800" draggable="true" data-word="${word}">${word}</span>`).join('')}
                        </div>
                        <div class="drop-target flex flex-wrap gap-2 min-h-[50px] p-2" id="scramble-drop-target-${index}" data-correct-order="${q.passiveWords.map(w => w.toLowerCase().replace(/[.,!?;]/g, '')).join(' ')}">
                            Drop words here to form the sentence.
                        </div>
                        <span id="passive-feedback-${index}" class="text-sm mt-1"></span>
                    `;
                }
                questionDiv.innerHTML = questionContent;
                passiveVoiceQuizDiv.appendChild(questionDiv);
            });

            // Add drag and drop listeners for scrambled words
            document.querySelectorAll('.draggable-word').forEach(word => {
                word.addEventListener('dragstart', (e) => {
                    draggedItem = e.target;
                    e.dataTransfer.setData('text/plain', e.target.dataset.word);
                    setTimeout(() => {
                        e.target.classList.add('hidden');
                    }, 0);
                });

                word.addEventListener('dragend', () => {
                    setTimeout(() => {
                        if (draggedItem) {
                            draggedItem.classList.remove('hidden');
                            draggedItem = null;
                        }
                    }, 0);
                });
            });

            document.querySelectorAll('.drop-target').forEach(target => {
                target.addEventListener('dragover', (e) => {
                    e.preventDefault(); // Allow drop
                    target.classList.add('hover');
                });

                target.addEventListener('dragleave', () => {
                    target.classList.remove('hover');
                });

                target.addEventListener('drop', (e) => {
                    e.preventDefault();
                    target.classList.remove('hover');
                    const word = e.dataTransfer.getData('text/plain');

                    // If it's the initial "Drop words here..." text, remove it
                    if (target.textContent.includes("Drop words here")) {
                        target.textContent = '';
                    }

                    const wordElement = document.createElement('span');
                    wordElement.classList.add('draggable-word', 'px-3', 'py-1', 'rounded-md', 'shadow-sm', 'cursor-grab', 'bg-blue-200', 'text-blue-800');
                    wordElement.textContent = word;
                    wordElement.setAttribute('draggable', true);
                    wordElement.dataset.word = word;
                    target.appendChild(wordElement);

                    // Re-add drag listeners for newly dropped words (if they are moved again)
                    wordElement.addEventListener('dragstart', (e) => {
                        draggedItem = e.target;
                        e.dataTransfer.setData('text/plain', e.target.dataset.word);
                        setTimeout(() => {
                            e.target.classList.add('hidden');
                        }, 0);
                    });
                    wordElement.addEventListener('dragend', () => {
                        setTimeout(() => {
                            if (draggedItem) {
                                draggedItem.classList.remove('hidden');
                                draggedItem = null;
                            }
                        }, 0);
                    });
                });
            });


            checkPassiveBtn.addEventListener('click', () => {
                let currentCorrectPassive = 0;
                passiveVoiceQuestions.forEach((q, index) => {
                    const feedbackSpan = document.getElementById(`passive-feedback-${index}`);

                    if (q.type === "typing") {
                        const userInput = document.getElementById(`passive-q${index}`).value.trim().toLowerCase().replace(/[.,!?;]/g, '');
                        const correctAnswer = document.getElementById(`passive-q${index}`).dataset.correctPassive;

                        if (userInput === correctAnswer) {
                            feedbackSpan.textContent = 'Correct!';
                            feedbackSpan.className = 'text-sm mt-1 correct-answer';
                            currentCorrectPassive++;
                        } else {
                            feedbackSpan.textContent = `Incorrect. Correct: "${q.passive}"`;
                            feedbackSpan.className = 'text-sm mt-1 incorrect-answer';
                        }
                    } else if (q.type === "multiple-choice") {
                        const selectedRadio = document.querySelector(`input[name="passive-q${index}"]:checked`);
                        if (selectedRadio && selectedRadio.value === q.correct.toLowerCase().replace(/[.,!?;]/g, '').trim()) {
                            feedbackSpan.textContent = 'Correct!';
                            feedbackSpan.className = 'text-sm mt-1 correct-answer';
                            currentCorrectPassive++;
                        } else {
                            feedbackSpan.textContent = `Incorrect. Correct: "${q.correct}"`;
                            feedbackSpan.className = 'text-sm mt-1 incorrect-answer';
                        }
                    } else if (q.type === "scramble") {
                        const dropTarget = document.getElementById(`scramble-drop-target-${index}`);
                        const droppedWords = Array.from(dropTarget.children).map(span => span.dataset.word.toLowerCase().replace(/[.,!?;]/g, '')).join(' ');
                        const correctAnswer = dropTarget.dataset.correctOrder;

                        if (droppedWords === correctAnswer) {
                            feedbackSpan.textContent = 'Correct!';
                            feedbackSpan.className = 'text-sm mt-1 correct-answer';
                            currentCorrectPassive++;
                        } else {
                            feedbackSpan.textContent = `Incorrect. Correct order: "${q.passiveWords.join(' ')}"`;
                            feedbackSpan.className = 'text-sm mt-1 incorrect-answer';
                        }
                    }
                });
                passiveSummary.textContent = `You got ${currentCorrectPassive} out of ${scores.totalPassiveVoice} correct!`;
                scores.passiveVoice = currentCorrectPassive;
                updateScoresDisplay();
            });

            // Initial scores display
            updateScoresDisplay();
        });
    </script>
</body>
</html>
